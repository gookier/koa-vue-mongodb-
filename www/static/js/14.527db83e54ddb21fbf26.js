webpackJsonp([14],{RMpn:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("pPmT"),r=s("qrgr"),l={props:["configform"],data:function(){var e=this;return{configVisible:!1,rules:{server_address:[{required:!0,message:this.$t("materialshelf.server_address_tips"),trigger:"blur"},{validator:function(t,s,i){0==/((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}/g.test(s)?i(new Error(e.$t("materialshelf.server_address_tips"))):i()},trigger:"blur"}],server_port:[{required:!0,message:this.$t("materialshelf.server_port_tips"),trigger:"blur"},{validator:function(t,s,i){0==/^([0-9]|[1-9]\d|[1-9]\d{2}|[1-9]\d{3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])$/.test(s)?i(new Error(e.$t("materialshelf.server_port_tips"))):i()},trigger:"blur"}],sleep_threshold_value:[{required:!0,message:this.$t("materialshelf.yuzhi_tips"),trigger:"blur"},{validator:function(t,s,i){0==/^[1-9]\d*$/.test(s)?i(new Error(e.$t("materialshelf.yuzhi"))):i()},trigger:"blur"}],timeout_threshold_value:[{required:!0,message:this.$t("materialshelf.yuzhi_tips"),trigger:"blur"},{validator:function(t,s,i){0==/^[1-9]\d*$/.test(s)?i(new Error(e.$t("materialshelf.yuzhi"))):i()},trigger:"blur"}]}}},methods:{open:function(e){this.configVisible=!0},reset:function(e){this.$refs.configform.resetFields()},configCancel:function(e){this.$refs.configform.resetFields(),this.configVisible=!1},configSave:function(e){var t=this;Object(r.o)({shelf_id:this.configform.shelf_id,shelf_config:this.configform}).then(function(e){e.result?(t.configVisible=!1,t.$message({showClose:!0,message:"success",type:"success"})):t.$message({showClose:!0,message:e.msg,type:"error"})})}}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:e.$t("materialshelf.config"),visible:e.configVisible,width:"720px"},on:{"update:visible":function(t){e.configVisible=t},close:function(t){return e.reset("configform")}}},[s("div",[s("el-form",{ref:"configform",attrs:{model:e.configform,rules:e.rules,"label-width":"100px",inline:!0}},[s("el-form-item",{attrs:{label:e.$t("materialshelf.server_address"),prop:"server_address"}},[s("el-input",{model:{value:e.configform.server_address,callback:function(t){e.$set(e.configform,"server_address",t)},expression:"configform.server_address"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("materialshelf.server_port"),prop:"server_port"}},[s("el-input",{model:{value:e.configform.server_port,callback:function(t){e.$set(e.configform,"server_port",t)},expression:"configform.server_port"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("materialshelf.send_info_addr"),prop:"send_info_addr"}},[s("el-input",{attrs:{disabled:""},model:{value:e.configform.send_info_addr,callback:function(t){e.$set(e.configform,"send_info_addr",t)},expression:"configform.send_info_addr"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("materialshelf.default_user"),prop:"default_user"}},[s("el-input",{model:{value:e.configform.default_user,callback:function(t){e.$set(e.configform,"default_user",t)},expression:"configform.default_user"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("materialshelf.shelf_id"),prop:"shelf_id"}},[s("el-input",{attrs:{disabled:""},model:{value:e.configform.shelf_id,callback:function(t){e.$set(e.configform,"shelf_id",t)},expression:"configform.shelf_id"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("materialshelf.shelf_type"),prop:"shelf_type"}},[s("el-input",{attrs:{disabled:""},model:{value:e.configform.shelf_type,callback:function(t){e.$set(e.configform,"shelf_type",t)},expression:"configform.shelf_type"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("materialshelf.sleep_threshold_value"),prop:"sleep_threshold_value"}},[s("el-input",{model:{value:e.configform.sleep_threshold_value,callback:function(t){e.$set(e.configform,"sleep_threshold_value",t)},expression:"configform.sleep_threshold_value"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("materialshelf.timeout_threshold_value"),prop:"timeout_threshold_value"}},[s("el-input",{model:{value:e.configform.timeout_threshold_value,callback:function(t){e.$set(e.configform,"timeout_threshold_value",t)},expression:"configform.timeout_threshold_value"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("materialshelf.shelf_login"),prop:"shelf_login"}},[s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":e.$t("materialshelf.on"),"inactive-text":e.$t("materialshelf.off"),"active-value":"on","inactive-value":"off"},model:{value:e.configform.shelf_login,callback:function(t){e.$set(e.configform,"shelf_login",t)},expression:"configform.shelf_login"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("materialshelf.strict_check_mate"),prop:"strict_check_mate"}},[s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"on","inactive-value":"off","active-text":e.$t("materialshelf.on"),"inactive-text":e.$t("materialshelf.off")},model:{value:e.configform.strict_check_mate,callback:function(t){e.$set(e.configform,"strict_check_mate",t)},expression:"configform.strict_check_mate"}})],1),e._v(" "),s("el-form-item",[s("el-button",{on:{click:function(t){return e.configCancel("configform")}}},[e._v(e._s(e.$t("common.cancel")))]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.configSave("configform")}}},[e._v(e._s(e.$t("common.save")))])],1)],1)],1)])],1)},staticRenderFns:[]},a={data:function(){return{categoryTypeList:[],warehouselist:[],bindingVisible:!1,bindingform:{shelf_id:"",warehouse_category_id:0,warehouse_name_id:0}}},methods:{open:function(e){this.getCategoryType(),this.bindingVisible=!0,this.bindingform.shelf_id=e.shelf_id,this.bindingform.warehouse_category_id=e.warehouse_category_id,this.bindingform.warehouse_name_id=e.warehouse_name_id,this.getWarehouseList()},getCategoryType:function(){var e=this;Object(r.i)({}).then(function(t){t.result&&(e.categoryTypeList=t.data_list)})},getWarehouseList:function(){var e=this;Object(r.j)({warehouse_category_id:this.bindingform.warehouse_category_id}).then(function(t){t.result&&(e.warehouselist=t.data)})},categoryTypeChange:function(){this.bindingform.warehouse_name_id="",this.getWarehouseList()},cancel:function(){this.bindingVisible=!1},save:function(){var e=this;Object(r.k)(this.bindingform).then(function(t){t.result?(e.bindingVisible=!1,e.$emit("getShelfList")):e.$message({showClose:!0,message:t.msg,type:"error"})})}}},o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:e.$t("materialshelf.bindingwarehouse"),visible:e.bindingVisible,width:"446px"},on:{"update:visible":function(t){e.bindingVisible=t}}},[s("div",{staticClass:"binding_div"},[[s("el-select",{attrs:{"value-key":"id",placeholder:"请选择库位类别"},on:{change:e.categoryTypeChange},model:{value:e.bindingform.warehouse_category_id,callback:function(t){e.$set(e.bindingform,"warehouse_category_id",t)},expression:"bindingform.warehouse_category_id"}},e._l(e.categoryTypeList,function(e){return s("el-option",{key:e.id,attrs:{label:e.category_name,value:e.id}})}),1)]],2),e._v(" "),s("div",{staticClass:"binding_div"},[[s("el-select",{attrs:{"value-key":"id",placeholder:"请选择库位"},model:{value:e.bindingform.warehouse_name_id,callback:function(t){e.$set(e.bindingform,"warehouse_name_id",t)},expression:"bindingform.warehouse_name_id"}},e._l(e.warehouselist,function(e){return s("el-option",{key:e.id,attrs:{label:e.warehouse_name,value:e.id}})}),1)]],2),e._v(" "),s("div",{staticClass:"binding_div"},[s("el-button",{on:{click:e.cancel}},[e._v("取消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)])],1)},staticRenderFns:[]};var c={components:{VMaterialconfig:s("VU/8")(l,n,!1,null,null,null).exports,VBinding:s("VU/8")(a,o,!1,function(e){s("gYCZ")},null,null).exports},data:function(){return{loading:!0,surpermissionFlag:Object(i.f)(),shelflist:[],config:"",timer:null,bindingInfo:""}},mounted:function(){this.getShelfList()},beforeDestroy:function(){this.timer&&clearInterval(this.timer)},methods:{getShelfList:function(){var e=this;Object(r.l)({}).then(function(t){e.loading=!1,t.result?e.shelflist=t.data:e.$message({showClose:!0,message:t.msg,type:"error"})})},stateFormatter:function(e){switch(parseInt(e.state)){case 1:return"在线";case-1:return"离线";case 3:return"报警"}},cancel:function(e){var t=this,s=this;Object(r.b)({shelf_id:e}).then(function(e){e.result?(t.$message({showClose:!0,message:t.$t("materialshelf.cancelWarningtips"),type:"success"}),t.timer=window.setTimeout(function(){s.getShelfList()},3e3)):t.$message({showClose:!0,message:e.msg,type:"error"})})},materialSet:function(e){this.config=e,this.$refs.materialconfig.open()},binding:function(e){this.bindingInfo=e,this.$refs.binding.open(e)},clearShelf:function(e){var t=this;this.$confirm(this.$t("materialshelf.cleartips"),this.$t("materialshelf.tips"),{confirmButtonText:this.$t("common.sure"),cancelButtonText:this.$t("common.cancel"),type:"warning"}).then(function(){Object(r.c)({shelf_id:e}).then(function(e){e.result?(t.$message({showClose:!0,message:t.$t("materialshelf.clearsuccess"),type:"success"}),t.getShelfList()):t.$message({showClose:!0,message:e.msg,type:"error"})})}).catch(function(){})},deleteShelf:function(e){var t=this;this.$confirm(this.$t("materialshelf.deletetips"),this.$t("materialshelf.tips"),{confirmButtonText:this.$t("common.sure"),cancelButtonText:this.$t("common.cancel"),type:"warning"}).then(function(){Object(r.h)({shelf_id:e}).then(function(e){e.result?(t.$message({showClose:!0,message:t.$t("materialshelf.deletesuccess"),type:"success"}),t.getShelfList()):t.$message({showClose:!0,message:e.msg,type:"error"})})}).catch(function(){})}}},f={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shelfwrapdiv"},[s("v-materialconfig",{ref:"materialconfig",attrs:{configform:e.config}}),e._v(" "),s("el-table",{attrs:{"header-cell-style":{background:"#DFEBF9",color:"#606266"},loading:e.loading,data:e.shelflist,"empty-text":e.$t("common.nodata"),border:""}},[s("el-table-column",{attrs:{prop:"shelf_id",label:e.$t("materialshelf.shelf_id")}}),e._v(" "),s("el-table-column",{attrs:{prop:"state",label:e.$t("materialshelf.state")},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.state?s("div",[s("span",{staticClass:"green"}),e._v(" "),s("span",[e._v("在线")])]):e._e(),e._v(" "),-1==t.row.state?s("div",[s("span",{staticClass:"gray"}),e._v(" "),s("span",[e._v("离线")])]):e._e(),e._v(" "),3==t.row.state?s("div",[s("span",{staticClass:"red"}),e._v(" "),s("span",[e._v("报警")])]):e._e(),e._v(" "),4==t.row.state?s("div",[s("span",{staticClass:"blue"}),e._v(" "),s("span",[e._v("续料")])]):e._e(),e._v(" "),8==t.row.state?s("div",[s("span",{staticClass:"purple"}),e._v(" "),s("span",[e._v("取料")])]):e._e(),e._v(" "),12==t.row.state?s("div",[s("span",{staticClass:"black"}),e._v(" "),s("span",[e._v("库位整理")])]):e._e(),e._v(" "),2==t.row.state?s("div",[s("span",{staticClass:"yellow"}),e._v(" "),s("span",[e._v("超时")])]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"warehouse_category_name",label:e.$t("materialshelf.warehouse_category_name")}}),e._v(" "),s("el-table-column",{attrs:{prop:"warehouse_name",label:e.$t("materialshelf.warehouse_name")}}),e._v(" "),s("el-table-column",{attrs:{prop:"normal_num",label:e.$t("materialshelf.normal_num")}}),e._v(" "),s("el-table-column",{attrs:{prop:"out_mate_num",label:e.$t("materialshelf.out_mate_num")}}),e._v(" "),s("el-table-column",{attrs:{prop:"in_use_num",label:e.$t("materialshelf.in_use_num")}}),e._v(" "),s("el-table-column",{attrs:{prop:"type",label:e.$t("materialshelf.shelf_type")}}),e._v(" "),s("el-table-column",{attrs:{prop:"state",label:e.$t("materialshelf.usage")},scopedSlots:e._u([{key:"default",fn:function(e){return[s("el-progress",{attrs:{percentage:Math.round(e.row.in_use_num/e.row.type*1e4)/100}})]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"state",width:e.surpermissionFlag?"456":"120",label:e.$t("common.operation")},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(s){return e.cancel(t.row.shelf_id)}}},[e._v(e._s(e.$t("materialshelf.cancelWarning")))]),e._v(" "),e.surpermissionFlag?s("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(s){return e.materialSet(t.row.shelf_config)}}},[e._v(e._s(e.$t("materialshelf.set")))]):e._e(),e._v(" "),e.surpermissionFlag?s("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(s){return e.binding(t.row)}}},[e._v(e._s(e.$t("materialshelf.bindingwarehouse")))]):e._e(),e._v(" "),e.surpermissionFlag?s("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(s){return e.clearShelf(t.row.shelf_id)}}},[e._v(e._s(e.$t("materialshelf.clearShelf")))]):e._e(),e._v(" "),e.surpermissionFlag?s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(s){return e.deleteShelf(t.row.shelf_id)}}},[e._v(e._s(e.$t("materialshelf.deleteShelf")))]):e._e()]}}])})],1),e._v(" "),s("v-binding",{ref:"binding",on:{getShelfList:e.getShelfList}})],1)},staticRenderFns:[]};var u=s("VU/8")(c,f,!1,function(e){s("omfA")},null,null);t.default=u.exports},gYCZ:function(e,t){},omfA:function(e,t){}});
//# sourceMappingURL=14.527db83e54ddb21fbf26.js.map